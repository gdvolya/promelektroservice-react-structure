{"ast":null,"code":"// pages/AdminPanel.jsx\nimport React from\"react\";import{useState,useEffect}from\"react\";import{collection,getDocs}from\"firebase/firestore\";import{db}from\"../firebase\";import*as XLSX from\"xlsx\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminPanel=_ref=>{let{enableExport}=_ref;const[submissions,setSubmissions]=useState([]);useEffect(()=>{const fetchSubmissions=async()=>{const querySnapshot=await getDocs(collection(db,\"submissions\"));setSubmissions(querySnapshot.docs.map(doc=>doc.data()));};fetchSubmissions();},[]);const exportToExcel=()=>{const worksheet=XLSX.utils.json_to_sheet(submissions);const workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,\"Заявки\");XLSX.writeFile(workbook,\"submissions.xlsx\");};return/*#__PURE__*/_jsxs(\"main\",{style:{padding:\"20px\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0410\\u0434\\u043C\\u0456\\u043D-\\u043F\\u0430\\u043D\\u0435\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"8\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u0406\\u043C\\u2019\\u044F\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041F\\u043E\\u0432\\u0456\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u043D\\u044F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:submissions.map((s,idx)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:s.name}),/*#__PURE__*/_jsx(\"td\",{children:s.email}),/*#__PURE__*/_jsx(\"td\",{children:s.phone}),/*#__PURE__*/_jsx(\"td\",{children:s.message})]},idx))})]}),enableExport&&/*#__PURE__*/_jsx(\"button\",{onClick:exportToExcel,style:{marginTop:\"20px\"},children:\"\\u0415\\u043A\\u0441\\u043F\\u043E\\u0440\\u0442\\u0443\\u0432\\u0430\\u0442\\u0438 \\u0432 Excel\"})]});};export default AdminPanel;","map":{"version":3,"names":["React","useState","useEffect","collection","getDocs","db","XLSX","jsx","_jsx","jsxs","_jsxs","AdminPanel","_ref","enableExport","submissions","setSubmissions","fetchSubmissions","querySnapshot","docs","map","doc","data","exportToExcel","worksheet","utils","json_to_sheet","workbook","book_new","book_append_sheet","writeFile","style","padding","children","border","cellPadding","s","idx","name","email","phone","message","onClick","marginTop"],"sources":["C:/Users/User/Desktop/promelektroservice-react-structure/src/pages/AdminPanel.jsx"],"sourcesContent":["// pages/AdminPanel.jsx\r\nimport React from \"react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { collection, getDocs } from \"firebase/firestore\";\r\nimport { db } from \"../firebase\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst AdminPanel = ({ enableExport }) => {\r\n  const [submissions, setSubmissions] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchSubmissions = async () => {\r\n      const querySnapshot = await getDocs(collection(db, \"submissions\"));\r\n      setSubmissions(querySnapshot.docs.map(doc => doc.data()));\r\n    };\r\n    fetchSubmissions();\r\n  }, []);\r\n\r\n  const exportToExcel = () => {\r\n    const worksheet = XLSX.utils.json_to_sheet(submissions);\r\n    const workbook = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Заявки\");\r\n    XLSX.writeFile(workbook, \"submissions.xlsx\");\r\n  };\r\n\r\n  return (\r\n    <main style={{ padding: \"20px\" }}>\r\n      <h1>Адмін-панель</h1>\r\n      <table border=\"1\" cellPadding=\"8\">\r\n        <thead>\r\n          <tr>\r\n            <th>Ім’я</th>\r\n            <th>Email</th>\r\n            <th>Телефон</th>\r\n            <th>Повідомлення</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {submissions.map((s, idx) => (\r\n            <tr key={idx}>\r\n              <td>{s.name}</td>\r\n              <td>{s.email}</td>\r\n              <td>{s.phone}</td>\r\n              <td>{s.message}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n\r\n      {enableExport && (\r\n        <button onClick={exportToExcel} style={{ marginTop: \"20px\" }}>\r\n          Експортувати в Excel\r\n        </button>\r\n      )}\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default AdminPanel;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,UAAU,CAAEC,OAAO,KAAQ,oBAAoB,CACxD,OAASC,EAAE,KAAQ,aAAa,CAChC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE7B,KAAM,CAAAC,UAAU,CAAGC,IAAA,EAAsB,IAArB,CAAEC,YAAa,CAAC,CAAAD,IAAA,CAClC,KAAM,CAACE,WAAW,CAAEC,cAAc,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAElDC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAb,OAAO,CAACD,UAAU,CAACE,EAAE,CAAE,aAAa,CAAC,CAAC,CAClEU,cAAc,CAACE,aAAa,CAACC,IAAI,CAACC,GAAG,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAC3D,CAAC,CACDL,gBAAgB,CAAC,CAAC,CACpB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAM,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,SAAS,CAAGjB,IAAI,CAACkB,KAAK,CAACC,aAAa,CAACX,WAAW,CAAC,CACvD,KAAM,CAAAY,QAAQ,CAAGpB,IAAI,CAACkB,KAAK,CAACG,QAAQ,CAAC,CAAC,CACtCrB,IAAI,CAACkB,KAAK,CAACI,iBAAiB,CAACF,QAAQ,CAAEH,SAAS,CAAE,QAAQ,CAAC,CAC3DjB,IAAI,CAACuB,SAAS,CAACH,QAAQ,CAAE,kBAAkB,CAAC,CAC9C,CAAC,CAED,mBACEhB,KAAA,SAAMoB,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAC,QAAA,eAC/BxB,IAAA,OAAAwB,QAAA,CAAI,qEAAY,CAAI,CAAC,cACrBtB,KAAA,UAAOuB,MAAM,CAAC,GAAG,CAACC,WAAW,CAAC,GAAG,CAAAF,QAAA,eAC/BxB,IAAA,UAAAwB,QAAA,cACEtB,KAAA,OAAAsB,QAAA,eACExB,IAAA,OAAAwB,QAAA,CAAI,0BAAI,CAAI,CAAC,cACbxB,IAAA,OAAAwB,QAAA,CAAI,OAAK,CAAI,CAAC,cACdxB,IAAA,OAAAwB,QAAA,CAAI,4CAAO,CAAI,CAAC,cAChBxB,IAAA,OAAAwB,QAAA,CAAI,0EAAY,CAAI,CAAC,EACnB,CAAC,CACA,CAAC,cACRxB,IAAA,UAAAwB,QAAA,CACGlB,WAAW,CAACK,GAAG,CAAC,CAACgB,CAAC,CAAEC,GAAG,gBACtB1B,KAAA,OAAAsB,QAAA,eACExB,IAAA,OAAAwB,QAAA,CAAKG,CAAC,CAACE,IAAI,CAAK,CAAC,cACjB7B,IAAA,OAAAwB,QAAA,CAAKG,CAAC,CAACG,KAAK,CAAK,CAAC,cAClB9B,IAAA,OAAAwB,QAAA,CAAKG,CAAC,CAACI,KAAK,CAAK,CAAC,cAClB/B,IAAA,OAAAwB,QAAA,CAAKG,CAAC,CAACK,OAAO,CAAK,CAAC,GAJbJ,GAKL,CACL,CAAC,CACG,CAAC,EACH,CAAC,CAEPvB,YAAY,eACXL,IAAA,WAAQiC,OAAO,CAAEnB,aAAc,CAACQ,KAAK,CAAE,CAAEY,SAAS,CAAE,MAAO,CAAE,CAAAV,QAAA,CAAC,uFAE9D,CAAQ,CACT,EACG,CAAC,CAEX,CAAC,CAED,cAAe,CAAArB,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}